import{u as p,d as u}from"./home.e9df3a69.js";import{_ as m}from"./plugin-vue_export-helper.21dcd24c.js";import{E as s}from"./request.538cacc7.js";import{I as g,o as h,c as _,s as v,x as b,b as y}from"./index.e2144cf2.js";import"./index.8d3be363.js";const U=r=>(v("data-v-356e94e4"),r=r(),b(),r),w={class:"zfile-office-viewer"},E=U(()=>y("div",{id:"office-body"},null,-1)),S=[E],N={__name:"OfficeViewer",setup(r){let t={fileUrl:String,fileName:String};g(()=>{f()});let n=p();const f=()=>{u().then(a=>{if(!a.data.installed){router.push("/install");return}n.updateGlobalConfig(a.data);let l=d("filePath");t.fileName=l.substr(l.lastIndexOf("/")+1),c(`${n.globalConfig.onlyOfficeUrl}/web-apps/apps/api/documents/api.js`,()=>{let e=t.fileName.lastIndexOf("."),o=t.fileName.substr(e+1);t.fileName=decodeURI(t.fileName),t.fileUrl=decodeURI(l),t.fileUrl=`${n.globalConfig.domain}/pd${t.fileUrl}`,l=decodeURI(l),console.log("props.fileUrl",t.fileUrl);const i={document:{fileType:o,title:t.fileName,url:t.fileUrl,lang:"zh-CN"},width:"100%",editorConfig:{callbackUrl:`${n.globalConfig.domain}/api/onlyOffice/edit${l}`,createUrl:null,lang:"zh-CN",mode:"edit",recent:null,user:{id:"2797f3743a9e4ee080ecd8270b349c68",name:"tiny-file"},customization:{autosave:!0,comment:!1,commentAuthorOnly:!1,compactToolbar:!1,feedback:!1,forcesave:!1,help:!1,review:!1,zoom:0,features:!1},permissions:{chat:!1},embedded:{embedUrl:null,fullscreenUrl:null,saveUrl:null,shareUrl:null,toolbarDocked:null},plugins:null}};new DocsAPI.DocEditor("office-body",i)})}).catch(a=>{a.message==="Network Error"&&s.error("\u52A0\u8F7D\u5931\u8D25\uFF0C\u65E0\u6CD5\u8FDE\u63A5\u5230\u670D\u52A1\u7AEF\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458.")})};function c(a,l){let e=document.createElement("script"),o=document.getElementsByTagName("head")[0];e.type="text/javascript",e.charset="UTF-8",e.src=a,e.addEventListener?(e.addEventListener("load",function(){l()},!1),e.addEventListener("error",function(){s.warning("\u8C03\u7528\u5728\u7EBF\u6587\u6863\u670D\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u5728\u7EBF\u6587\u6863\u670D\u52A1\u662F\u5426\u6B63\u5E38")},!1)):e.attachEvent&&e.attachEvent("onreadystatechange",function(){var i=window.event.srcElement;i.readyState==="loaded"&&l()}),o.appendChild(e)}function d(a){let e=window.location.search.substring(1).split("&");for(let o=0;o<e.length;o++){let i=e[o].split("=");if(i[0]==a)return i[1]}return!1}return(a,l)=>(h(),_("div",w,S))}};var k=m(N,[["__scopeId","data-v-356e94e4"]]);export{k as default};
