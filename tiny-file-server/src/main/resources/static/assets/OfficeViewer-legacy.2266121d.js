!function(){var e=document.createElement("style");e.innerHTML=".zfile-office-viewer[data-v-356e94e4],#office-body[data-v-356e94e4]{height:100%;width:100%}\n",document.head.appendChild(e),System.register(["./home-legacy.0cfc7ac0.js","./plugin-vue_export-helper-legacy.7bb61c33.js","./request-legacy.2cf0cbaa.js","./index-legacy.36e5d91f.js","./index-legacy.5f3309bc.js"],(function(e){"use strict";var n,t,a,i,l,c,o,r,f,d;return{setters:[function(e){n=e.u,t=e.d},function(e){a=e._},function(e){i=e.E},function(e){l=e.I,c=e.o,o=e.c,r=e.s,f=e.x,d=e.b},function(){}],execute:function(){var u={class:"zfile-office-viewer"},s=[function(e){return r("data-v-356e94e4"),e=e(),f(),e}((function(){return d("div",{id:"office-body"},null,-1)}))];e("default",a({__name:"OfficeViewer",setup:function(e){var a={fileUrl:String,fileName:String};l((function(){f()}));var r=n(),f=function(){t().then((function(e){if(e.data.installed){r.updateGlobalConfig(e.data);var n=function(e){for(var n=window.location.search.substring(1).split("&"),t=0;t<n.length;t++){var a=n[t].split("=");if(a[0]==e)return a[1]}return!1}("filePath");a.fileName=n.substr(n.lastIndexOf("/")+1),function(e,n){var t=document.createElement("script"),a=document.getElementsByTagName("head")[0];t.type="text/javascript",t.charset="UTF-8",t.src=e,t.addEventListener?(t.addEventListener("load",(function(){n()}),!1),t.addEventListener("error",(function(){i.warning("调用在线文档服务失败，请检查在线文档服务是否正常")}),!1)):t.attachEvent&&t.attachEvent("onreadystatechange",(function(){"loaded"===window.event.srcElement.readyState&&n()}));a.appendChild(t)}("".concat(r.globalConfig.onlyOfficeUrl,"/web-apps/apps/api/documents/api.js"),(function(){var e=a.fileName.lastIndexOf("."),t=a.fileName.substr(e+1);a.fileName=decodeURI(a.fileName),a.fileUrl=decodeURI(n),a.fileUrl="".concat(r.globalConfig.domain,"/pd").concat(a.fileUrl),n=decodeURI(n),console.log("props.fileUrl",a.fileUrl);var i={document:{fileType:t,title:a.fileName,url:a.fileUrl,lang:"zh-CN"},width:"100%",editorConfig:{callbackUrl:"".concat(r.globalConfig.domain,"/api/onlyOffice/edit").concat(n),createUrl:null,lang:"zh-CN",mode:"edit",recent:null,user:{id:"2797f3743a9e4ee080ecd8270b349c68",name:"tiny-file"},customization:{autosave:!0,comment:!1,commentAuthorOnly:!1,compactToolbar:!1,feedback:!1,forcesave:!1,help:!1,review:!1,zoom:0,features:!1},permissions:{chat:!1},embedded:{embedUrl:null,fullscreenUrl:null,saveUrl:null,shareUrl:null,toolbarDocked:null},plugins:null}};new DocsAPI.DocEditor("office-body",i)}))}else router.push("/install")})).catch((function(e){"Network Error"===e.message&&i.error("加载失败，无法连接到服务端，请联系管理员.")}))};return function(e,n){return c(),o("div",u,s)}}},[["__scopeId","data-v-356e94e4"]]))}}}))}();
