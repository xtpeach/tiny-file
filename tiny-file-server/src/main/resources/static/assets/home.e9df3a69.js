import{z as L,A as a,ae as v}from"./index.e2144cf2.js";import{d as i}from"./request.538cacc7.js";const o=L([]);let s=null;function w(e){e&&(s=e);const c=()=>{s.proxy.$refs.fileTableRef.clearSelection()},g=(l,n)=>{(l==null?void 0:l.type)!=="BACK"&&s.proxy.$refs.fileTableRef.toggleRowSelection(l,n)},u=()=>{s.proxy.$refs.fileTableRef.toggleAllSelection()},d=l=>l.type==="FILE"||l.type==="FOLDER",h=a(()=>o.value.length>0?o.value[o.value.length-1]:null),r=a(()=>o.value.filter(l=>l.type==="FILE")),f=a(()=>o.value.filter(l=>l.type==="FOLDER")),p=l=>{o.value=l},S=({row:l,rowIndex:n})=>(l.index=n,o.value.indexOf(l)!==-1?"select-row":""),b=a(()=>{let l=o.value.length,n=r.value.length,F=f.value.length,m=l===1,C=l>1;return{isSingleSelect:m,isMultiSelect:C,isAllFile:n===l,isAllFolder:F===l}});return{checkSelectable:d,tableRowClassName:S,selectRowsChange:p,selectRow:h,selectRows:o,selectFiles:r,selectFolders:f,selectStatistics:b,clearSelection:c,toggleRowSelection:g,toggleAllSelection:u}}let{selectStatistics:t}=w();const x=v("storageConfigStore",{state:()=>({globalConfig:{siteName:"",directLinkPrefix:"",infoEnable:!1,showLinkBtn:!1,recordDownloadLog:!1,showShortLink:!1,showPathLink:!1,tableSize:"default",rootShowStorage:!0,fileClickMode:"dbclick",showDocument:!1,debugMode:!1,domain:"",icp:"",avatar:"",announcement:"",layout:"full",showAnnouncement:!1,searchEnable:!1,showLogin:!1},folderConfig:{readmeText:null,readmeDisplayMode:null,defaultSwitchToImgMode:!1,enableFileOperator:!1}}),getters:{permission:e=>({open:t.value.isSingleSelect&&t.value.isAllFolder,preview:t.value.isAllFile&&t.value.isSingleSelect,download:t.value.isAllFile,link:t.value.isAllFile&&e.globalConfig.showLinkBtn&&(e.globalConfig.showShortLink||e.globalConfig.showPathLink),rename:e.folderConfig.enableFileOperator&&t.value.isSingleSelect,delete:e.folderConfig.enableFileOperator,newFolder:e.folderConfig.enableFileOperator,upload:e.folderConfig.enableFileOperator,pathLink:e.globalConfig.showPathLink,shortLink:e.globalConfig.showShortLink})},actions:{updateGlobalConfig(e){this.globalConfig=e},updateFolderConfig(e){this.folderConfig=e}}}),O=e=>i({url:"/api/storage/files",method:"post",data:e,config:{showDefaultMsg:!1}}),D=e=>i({url:"/api/storage/file/item",method:"post",data:e,config:{responseIntercept:!1,showDefaultMsg:!1}}),M=()=>i({url:"/api/site/config/global",method:"get"}),E=e=>i({url:"/api/site/config/storage",method:"post",data:e}),q=e=>i({url:"/api/short-link/batch/generate",method:"post",data:e});export{w as a,q as b,E as c,M as d,D as e,O as l,x as u};
