import{u as f}from"./home.e9df3a69.js";import{_ as c}from"./plugin-vue_export-helper.21dcd24c.js";import{E as d}from"./request.538cacc7.js";import{I as p,o as u,c as m,s as _,x as h,b as v}from"./index.e2144cf2.js";import"./index.8d3be363.js";const g=a=>(_("data-v-fefcb72c"),a=a(),h(),a),b={class:"zfile-office-viewer"},y=g(()=>v("div",{id:"office-body"},null,-1)),w=[y],U={__name:"OfficeViewer",props:{fileUrl:String,fileName:String},setup(a){const t=a;let s=f();p(()=>{n(`${s.globalConfig.onlyOfficeUrl}/web-apps/apps/api/documents/api.js`,()=>{const o=t.fileName.lastIndexOf("."),l=t.fileName.substr(o+1);let e=t.fileUrl.substr(0,t.fileUrl.lastIndexOf("/"));console.log("filePath",t.fileUrl),e=e.replace("/pd","/api/onlyOffice/edit")+`/${t.fileName}`,console.log("filePath-re",e);const i={document:{fileType:l,title:t.fileName,url:t.fileUrl,lang:"zh-CN"},width:"100%",editorConfig:{callbackUrl:e,createUrl:null,lang:"zh-CN",mode:"edit",recent:null,user:{id:"2797f3743a9e4ee080ecd8270b349c68",name:"tiny-file"},customization:{autosave:!0,comment:!1,commentAuthorOnly:!1,compactToolbar:!1,feedback:!1,forcesave:!1,help:!1,review:!1,zoom:0,features:!1},permissions:{chat:!1},embedded:{embedUrl:null,fullscreenUrl:null,saveUrl:null,shareUrl:null,toolbarDocked:null},plugins:null}};new DocsAPI.DocEditor("office-body",i)})});function n(o,l){let e=document.createElement("script"),i=document.getElementsByTagName("head")[0];e.type="text/javascript",e.charset="UTF-8",e.src=o,e.addEventListener?(e.addEventListener("load",function(){l()},!1),e.addEventListener("error",function(){d.warning("\u8C03\u7528\u5728\u7EBF\u6587\u6863\u670D\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u5728\u7EBF\u6587\u6863\u670D\u52A1\u662F\u5426\u6B63\u5E38")},!1)):e.attachEvent&&e.attachEvent("onreadystatechange",function(){var r=window.event.srcElement;r.readyState==="loaded"&&l()}),i.appendChild(e)}return(o,l)=>(u(),m("div",b,w))}};var O=c(U,[["__scopeId","data-v-fefcb72c"]]);export{O as default};
