var Xe=(t,e,a)=>new Promise((n,r)=>{var s=l=>{try{i(a.next(l))}catch(u){r(u)}},o=l=>{try{i(a.throw(l))}catch(u){r(u)}},i=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,o);i((a=a.apply(t,e)).next())});import{u as Ta,d as se,e as Pa,E as N,f as xt,g as Aa,h as Mt}from"./request.538cacc7.js";import{ae as Ea,i as ze,z as M,A as Q,w as Ee,E as La,B as pe,I as za,a7 as pt,o as $,k as Ma,l as Da,c as K,n as Qe,v as Ze,b as F,K as Je,L as et,m as ve,T as _a,af as Ra,q as Ba,ag as Oa,a5 as Ke,s as Fa,x as Ia,j as ae,D as $a,ah as ja,f as Ct,ai as Ua,O as ue}from"./index.e2144cf2.js";import{c as U}from"./common.83b6e491.js";import{u as Me,a as kt,l as Va,c as Ka}from"./home.e9df3a69.js";import{u as Na}from"./useCommon.cd9f3905.js";import{E as re}from"./index.911dd79c.js";import{E as ht}from"./index.f7e8a145.js";const he=Ea("fileDataStore",{state:()=>({currentClickRow:{},currentRightClickRow:{},currentStorageSource:{id:null,type:{description:"",key:""}},imgMode:!1,newImgMode:!1,oldStorageKey:null,searchParam:"",fileListSource:[],audioArray:[],audioIndex:0}),getters:{filterFileByType:t=>e=>t.fileListSource.filter(function(a){if(a.type==="BACK")return!1;let n=a.name,r=n.substr(n.lastIndexOf(".")+1).toLowerCase();return U.constant.fileTypeMap[e].indexOf(r)!==-1}),fileList:t=>{let e=t.fileListSource;return e.forEach(a=>{if(a.icon||(a.icon=U.getFileIconName(a)),a.preview!==null){var n=U.getFileType(a.name);n?(a.fileType=n,a.preview=U.constant.previewFileType.indexOf(n)!==-1):a.preview=!1}}),e}},actions:{updateCurrentStorageSource(t){this.currentStorageSource=t},updateAudioIndex(t){this.audioIndex=t},updateAudioList(t){this.audioArray=t},updateCurrentClickRow(t){this.currentClickRow=t},updateCurrentRightClickRow(t){this.currentRightClickRow=t},updateFileList(t){this.fileListSource=t},updateOldStorageKey(t){this.oldStorageKey=t}}}),Wa=typeof process=="object"&&process&&process.platform==="win32";var Ha=Wa?{sep:"\\"}:{sep:"/"},qa=sa;function sa(t,e,a){t instanceof RegExp&&(t=Dt(t,a)),e instanceof RegExp&&(e=Dt(e,a));var n=ua(t,e,a);return n&&{start:n[0],end:n[1],pre:a.slice(0,n[0]),body:a.slice(n[0]+t.length,n[1]),post:a.slice(n[1]+e.length)}}function Dt(t,e){var a=e.match(t);return a?a[0]:null}sa.range=ua;function ua(t,e,a){var n,r,s,o,i,l=a.indexOf(t),u=a.indexOf(e,l+1),f=l;if(l>=0&&u>0){if(t===e)return[l,u];for(n=[],s=a.length;f>=0&&!i;)f==l?(n.push(f),l=a.indexOf(t,f+1)):n.length==1?i=[n.pop(),u]:(r=n.pop(),r<s&&(s=r,o=u),u=a.indexOf(e,f+1)),f=l<u&&l>=0?l:u;n.length&&(i=[s,o])}return i}var ca=qa,Ga=Qa,da="\0SLASH"+Math.random()+"\0",fa="\0OPEN"+Math.random()+"\0",Tt="\0CLOSE"+Math.random()+"\0",ga="\0COMMA"+Math.random()+"\0",pa="\0PERIOD"+Math.random()+"\0";function tt(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Ya(t){return t.split("\\\\").join(da).split("\\{").join(fa).split("\\}").join(Tt).split("\\,").join(ga).split("\\.").join(pa)}function Xa(t){return t.split(da).join("\\").split(fa).join("{").split(Tt).join("}").split(ga).join(",").split(pa).join(".")}function ha(t){if(!t)return[""];var e=[],a=ca("{","}",t);if(!a)return t.split(",");var n=a.pre,r=a.body,s=a.post,o=n.split(",");o[o.length-1]+="{"+r+"}";var i=ha(s);return s.length&&(o[o.length-1]+=i.shift(),o.push.apply(o,i)),e.push.apply(e,o),e}function Qa(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),ke(Ya(t),!0).map(Xa)):[]}function Za(t){return"{"+t+"}"}function Ja(t){return/^-?0\d/.test(t)}function en(t,e){return t<=e}function tn(t,e){return t>=e}function ke(t,e){var a=[],n=ca("{","}",t);if(!n)return[t];var r=n.pre,s=n.post.length?ke(n.post,!1):[""];if(/\$$/.test(n.pre))for(var o=0;o<s.length;o++){var i=r+"{"+n.body+"}"+s[o];a.push(i)}else{var l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),f=l||u,p=n.body.indexOf(",")>=0;if(!f&&!p)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+Tt+n.post,ke(t)):[t];var m;if(f)m=n.body.split(/\.\./);else if(m=ha(n.body),m.length===1&&(m=ke(m[0],!1).map(Za),m.length===1))return s.map(function(k){return n.pre+m[0]+k});var d;if(f){var h=tt(m[0]),C=tt(m[1]),_=Math.max(m[0].length,m[1].length),E=m.length==3?Math.abs(tt(m[2])):1,D=en,S=C<h;S&&(E*=-1,D=tn);var w=m.some(Ja);d=[];for(var c=h;D(c,C);c+=E){var v;if(u)v=String.fromCharCode(c),v==="\\"&&(v="");else if(v=String(c),w){var g=_-v.length;if(g>0){var y=new Array(g+1).join("0");c<0?v="-"+y+v.slice(1):v=y+v}}d.push(v)}}else{d=[];for(var x=0;x<m.length;x++)d.push.apply(d,ke(m[x],!1))}for(var x=0;x<d.length;x++)for(var o=0;o<s.length;o++){var i=r+d[x]+s[o];(!e||f||i)&&a.push(i)}}return a}const V=va=(t,e,a={})=>(Ne(e),!a.nocomment&&e.charAt(0)==="#"?!1:new qe(e,a).match(t));var va=V;const vt=Ha;V.sep=vt.sep;const H=Symbol("globstar **");V.GLOBSTAR=H;const an=Ga,_t={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},mt="[^/]",at=mt+"*?",nn="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",rn="(?:(?!(?:\\/|^)\\.).)*?",ma=t=>t.split("").reduce((e,a)=>(e[a]=!0,e),{}),Rt=ma("().*{}+?[]^$\\!"),on=ma("[.("),Bt=/\/+/;V.filter=(t,e={})=>(a,n,r)=>V(a,t,e);const ee=(t,e={})=>{const a={};return Object.keys(t).forEach(n=>a[n]=t[n]),Object.keys(e).forEach(n=>a[n]=e[n]),a};V.defaults=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return V;const e=V,a=(n,r,s)=>e(n,r,ee(t,s));return a.Minimatch=class extends e.Minimatch{constructor(r,s){super(r,ee(t,s))}},a.Minimatch.defaults=n=>e.defaults(ee(t,n)).Minimatch,a.filter=(n,r)=>e.filter(n,ee(t,r)),a.defaults=n=>e.defaults(ee(t,n)),a.makeRe=(n,r)=>e.makeRe(n,ee(t,r)),a.braceExpand=(n,r)=>e.braceExpand(n,ee(t,r)),a.match=(n,r,s)=>e.match(n,r,ee(t,s)),a};V.braceExpand=(t,e)=>ya(t,e);const ya=(t,e={})=>(Ne(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:an(t)),ln=1024*64,Ne=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>ln)throw new TypeError("pattern is too long")},_e=Symbol("subparse");V.makeRe=(t,e)=>new qe(t,e||{}).makeRe();V.match=(t,e,a={})=>{const n=new qe(e,a);return t=t.filter(r=>n.match(r)),n.options.nonull&&!t.length&&t.push(e),t};const sn=t=>t.replace(/\\(.)/g,"$1"),un=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");class qe{constructor(e,a){Ne(e),a||(a={}),this.options=a,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!a.windowsPathsNoEscape||a.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!a.partial,this.make()}debug(){}make(){const e=this.pattern,a=this.options;if(!a.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();a.debug&&(this.debug=(...r)=>console.error(...r)),this.debug(this.pattern,n),n=this.globParts=n.map(r=>r.split(Bt)),this.debug(this.pattern,n),n=n.map((r,s,o)=>r.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(r=>r.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let a=!1,n=0;for(let r=0;r<e.length&&e.charAt(r)==="!";r++)a=!a,n++;n&&(this.pattern=e.substr(n)),this.negate=a}matchOne(e,a,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:a}),this.debug("matchOne",e.length,a.length);for(var s=0,o=0,i=e.length,l=a.length;s<i&&o<l;s++,o++){this.debug("matchOne loop");var u=a[o],f=e[s];if(this.debug(a,u,f),u===!1)return!1;if(u===H){this.debug("GLOBSTAR",[a,u,f]);var p=s,m=o+1;if(m===l){for(this.debug("** at the end");s<i;s++)if(e[s]==="."||e[s]===".."||!r.dot&&e[s].charAt(0)===".")return!1;return!0}for(;p<i;){var d=e[p];if(this.debug(`
globstar while`,e,p,a,m,d),this.matchOne(e.slice(p),a.slice(m),n))return this.debug("globstar found match!",p,i,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,p,a,m);break}this.debug("globstar swallow a segment, and continue"),p++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,p,a,m),p===i))}var h;if(typeof u=="string"?(h=f===u,this.debug("string match",u,f,h)):(h=f.match(u),this.debug("pattern match",u,f,h)),!h)return!1}if(s===i&&o===l)return!0;if(s===i)return n;if(o===l)return s===i-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return ya(this.pattern,this.options)}parse(e,a){Ne(e);const n=this.options;if(e==="**")if(n.noglobstar)e="*";else return H;if(e==="")return"";let r="",s=!!n.nocase,o=!1;const i=[],l=[];let u,f=!1,p=-1,m=-1,d,h,C;const _=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",E=()=>{if(u){switch(u){case"*":r+=at,s=!0;break;case"?":r+=mt,s=!0;break;default:r+="\\"+u;break}this.debug("clearStateChar %j %j",u,r),u=!1}};for(let w=0,c;w<e.length&&(c=e.charAt(w));w++){if(this.debug("%s	%s %s %j",e,w,r,c),o){if(c==="/")return!1;Rt[c]&&(r+="\\"),r+=c,o=!1;continue}switch(c){case"/":return!1;case"\\":E(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,w,r,c),f){this.debug("  in class"),c==="!"&&w===m+1&&(c="^"),r+=c;continue}this.debug("call clearStateChar %j",u),E(),u=c,n.noext&&E();continue;case"(":if(f){r+="(";continue}if(!u){r+="\\(";continue}i.push({type:u,start:w-1,reStart:r.length,open:_t[u].open,close:_t[u].close}),r+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,r),u=!1;continue;case")":if(f||!i.length){r+="\\)";continue}E(),s=!0,h=i.pop(),r+=h.close,h.type==="!"&&l.push(h),h.reEnd=r.length;continue;case"|":if(f||!i.length){r+="\\|";continue}E(),r+="|";continue;case"[":if(E(),f){r+="\\"+c;continue}f=!0,m=w,p=r.length,r+=c;continue;case"]":if(w===m+1||!f){r+="\\"+c;continue}d=e.substring(m+1,w);try{RegExp("["+d+"]")}catch(v){C=this.parse(d,_e),r=r.substr(0,p)+"\\["+C[0]+"\\]",s=s||C[1],f=!1;continue}s=!0,f=!1,r+=c;continue;default:E(),Rt[c]&&!(c==="^"&&f)&&(r+="\\"),r+=c;break}}for(f&&(d=e.substr(m+1),C=this.parse(d,_e),r=r.substr(0,p)+"\\["+C[0],s=s||C[1]),h=i.pop();h;h=i.pop()){let w;w=r.slice(h.reStart+h.open.length),this.debug("setting tail",r,h),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,(v,g,y)=>(y||(y="\\"),g+g+y+"|")),this.debug(`tail=%j
   %s`,w,w,h,r);const c=h.type==="*"?at:h.type==="?"?mt:"\\"+h.type;s=!0,r=r.slice(0,h.reStart)+c+"\\("+w}E(),o&&(r+="\\\\");const D=on[r.charAt(0)];for(let w=l.length-1;w>-1;w--){const c=l[w],v=r.slice(0,c.reStart),g=r.slice(c.reStart,c.reEnd-8);let y=r.slice(c.reEnd);const x=r.slice(c.reEnd-8,c.reEnd)+y,k=v.split("(").length-1;let z=y;for(let T=0;T<k;T++)z=z.replace(/\)[+*?]?/,"");y=z;const L=y===""&&a!==_e?"$":"";r=v+g+y+L+x}if(r!==""&&s&&(r="(?=.)"+r),D&&(r=_+r),a===_e)return[r,s];if(!s)return sn(e);const S=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+r+"$",S),{_glob:e,_src:r})}catch(w){return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const a=this.options,n=a.noglobstar?at:a.dot?nn:rn,r=a.nocase?"i":"";let s=e.map(o=>(o=o.map(i=>typeof i=="string"?un(i):i===H?H:i._src).reduce((i,l)=>(i[i.length-1]===H&&l===H||i.push(l),i),[]),o.forEach((i,l)=>{i!==H||o[l-1]===H||(l===0?o.length>1?o[l+1]="(?:\\/|"+n+"\\/)?"+o[l+1]:o[l]=n:l===o.length-1?o[l-1]+="(?:\\/|"+n+")?":(o[l-1]+="(?:\\/|\\/"+n+"\\/)"+o[l+1],o[l+1]=H))}),o.filter(i=>i!==H).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,r)}catch(o){this.regexp=!1}return this.regexp}match(e,a=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&a)return!0;const n=this.options;vt.sep!=="/"&&(e=e.split(vt.sep).join("/")),e=e.split(Bt),this.debug(this.pattern,"split",e);const r=this.set;this.debug(this.pattern,"set",r);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<r.length;o++){const i=r[o];let l=e;if(n.matchBase&&i.length===1&&(l=[s]),this.matchOne(l,i,a))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return V.defaults(e).Minimatch}}V.Minimatch=qe;var cn=va,Le={};Object.defineProperty(Le,"__esModule",{value:!0});var We=Le.removeDuplicateSlashes=Le.transform=void 0;const dn=/(?!^)\/{2,}/g;function fn(t){return t.map(e=>ba(e))}Le.transform=fn;function ba(t){return t.replace(dn,"/")}We=Le.removeDuplicateSlashes=ba;let{storageKey:Re,currentPath:gn}=ze();const ce=Ta("zfile-pwd-cache",{});function Pt(){return{putPathPwd:(a,n)=>{a&&(a=a.startsWith("/")?a:"/"+a,ce.value[Re.value]||(ce.value[Re.value]={}),a.endsWith("**")&&!a.endsWith("/**")&&(a=We(a.substring(0,a.length-2)+"/**"),console.log("\u68C0\u6D4B\u5230\u5BC6\u7801\u6587\u4EF6\u5939\u901A\u914D\u7B26 ** \u524D\u672A\u5199 /\uFF0C\u81EA\u52A8\u5C06\u5176\u4FEE\u6B63\u4E3A\u4E3A\uFF1A",a)),ce.value[Re.value][a]=n)},getPathPwd:a=>{let n=a||gn.value;n=U.removeDuplicateSeparator("/"+n+"/");for(let r of Object.keys(ce.value))if(r===Re.value){for(let s of Object.keys(ce.value[r]))if(cn(n,s))return ce.value[r][s]}return""}}}let{getPathPwd:Ge}=Pt();const pn=t=>(t.password=Ge(t.path),se({url:"/api/file/operator/mkdir",method:"post",data:t})),hn=t=>se({url:"/api/file/operator/delete/batch",method:"post",data:t}),vn=t=>(t.password=Ge(t.path),se({url:"/api/file/operator/rename/file",method:"post",data:t})),mn=t=>(t.password=Ge(t.path),se({url:"/api/file/operator/rename/folder",method:"post",data:t})),yn=t=>(t.password=Ge(t.path),se({url:"/api/file/operator/upload/file",method:"post",data:t}));function G(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function Ot(t,e){for(var a="",n=0,r=-1,s=0,o,i=0;i<=t.length;++i){if(i<t.length)o=t.charCodeAt(i);else{if(o===47)break;o=47}if(o===47){if(!(r===i-1||s===1))if(r!==i-1&&s===2){if(a.length<2||n!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var l=a.lastIndexOf("/");if(l!==a.length-1){l===-1?(a="",n=0):(a=a.slice(0,l),n=a.length-1-a.lastIndexOf("/")),r=i,s=0;continue}}else if(a.length===2||a.length===1){a="",n=0,r=i,s=0;continue}}e&&(a.length>0?a+="/..":a="..",n=2)}else a.length>0?a+="/"+t.slice(r+1,i):a=t.slice(r+1,i),n=i-r-1;r=i,s=0}else o===46&&s!==-1?++s:s=-1}return a}function bn(t,e){var a=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return a?a===e.root?a+n:a+t+n:n}var ge={resolve:function(){for(var e="",a=!1,n,r=arguments.length-1;r>=-1&&!a;r--){var s;r>=0?s=arguments[r]:(n===void 0&&(n=process.cwd()),s=n),G(s),s.length!==0&&(e=s+"/"+e,a=s.charCodeAt(0)===47)}return e=Ot(e,!a),a?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(G(e),e.length===0)return".";var a=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Ot(e,!a),e.length===0&&!a&&(e="."),e.length>0&&n&&(e+="/"),a?"/"+e:e},isAbsolute:function(e){return G(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,a=0;a<arguments.length;++a){var n=arguments[a];G(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":ge.normalize(e)},relative:function(e,a){if(G(e),G(a),e===a||(e=ge.resolve(e),a=ge.resolve(a),e===a))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var r=e.length,s=r-n,o=1;o<a.length&&a.charCodeAt(o)===47;++o);for(var i=a.length,l=i-o,u=s<l?s:l,f=-1,p=0;p<=u;++p){if(p===u){if(l>u){if(a.charCodeAt(o+p)===47)return a.slice(o+p+1);if(p===0)return a.slice(o+p)}else s>u&&(e.charCodeAt(n+p)===47?f=p:p===0&&(f=0));break}var m=e.charCodeAt(n+p),d=a.charCodeAt(o+p);if(m!==d)break;m===47&&(f=p)}var h="";for(p=n+f+1;p<=r;++p)(p===r||e.charCodeAt(p)===47)&&(h.length===0?h+="..":h+="/..");return h.length>0?h+a.slice(o+f):(o+=f,a.charCodeAt(o)===47&&++o,a.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(G(e),e.length===0)return".";for(var a=e.charCodeAt(0),n=a===47,r=-1,s=!0,o=e.length-1;o>=1;--o)if(a=e.charCodeAt(o),a===47){if(!s){r=o;break}}else s=!1;return r===-1?n?"/":".":n&&r===1?"//":e.slice(0,r)},basename:function(e,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');G(e);var n=0,r=-1,s=!0,o;if(a!==void 0&&a.length>0&&a.length<=e.length){if(a.length===e.length&&a===e)return"";var i=a.length-1,l=-1;for(o=e.length-1;o>=0;--o){var u=e.charCodeAt(o);if(u===47){if(!s){n=o+1;break}}else l===-1&&(s=!1,l=o+1),i>=0&&(u===a.charCodeAt(i)?--i===-1&&(r=o):(i=-1,r=l))}return n===r?r=l:r===-1&&(r=e.length),e.slice(n,r)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!s){n=o+1;break}}else r===-1&&(s=!1,r=o+1);return r===-1?"":e.slice(n,r)}},extname:function(e){G(e);for(var a=-1,n=0,r=-1,s=!0,o=0,i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(l===47){if(!s){n=i+1;break}continue}r===-1&&(s=!1,r=i+1),l===46?a===-1?a=i:o!==1&&(o=1):a!==-1&&(o=-1)}return a===-1||r===-1||o===0||o===1&&a===r-1&&a===n+1?"":e.slice(a,r)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return bn("/",e)},parse:function(e){G(e);var a={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return a;var n=e.charCodeAt(0),r=n===47,s;r?(a.root="/",s=1):s=0;for(var o=-1,i=0,l=-1,u=!0,f=e.length-1,p=0;f>=s;--f){if(n=e.charCodeAt(f),n===47){if(!u){i=f+1;break}continue}l===-1&&(u=!1,l=f+1),n===46?o===-1?o=f:p!==1&&(p=1):o!==-1&&(p=-1)}return o===-1||l===-1||p===0||p===1&&o===l-1&&o===i+1?l!==-1&&(i===0&&r?a.base=a.name=e.slice(1,l):a.base=a.name=e.slice(i,l)):(i===0&&r?(a.name=e.slice(1,o),a.base=e.slice(1,l)):(a.name=e.slice(i,o),a.base=e.slice(i,l)),a.ext=e.slice(o,l)),i>0?a.dir=e.slice(0,i-1):r&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};ge.posix=ge;var Be=ge;const Rr=t=>se({url:"/api/site/reset-password",method:"get",data:t}),wn=t=>se({url:"/api/storage/list",method:"get",data:t});let Ft=he(),It=Me(),{routerRef:nt,fullpath:Sn,storageKey:Oe}=ze(),te=M([]),me=M(),$t=!1;function xn(){let t=It.globalConfig.rootShowStorage,e=()=>new Promise(i=>{wn().then(l=>{if(te.value=l.data,te.value.length===0){re.confirm("\u5F53\u524D\u65E0\u53EF\u7528\u5B58\u50A8\u6E90\uFF0C\u662F\u5426\u8DF3\u8F6C\u81F3\u7BA1\u7406\u5458\u9875\u9762\u6DFB\u52A0\u5B58\u50A8\u6E90\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"info",callback:u=>{u==="confirm"&&nt.value.push("/login")}});return}a(t),i(l)})});const a=i=>{Oe.value?o(Oe.value)?me.value=Oe.value:s():i?(Ft.updateFileList(n.value),document.title=It.globalConfig.siteName+" | \u9996\u9875"):s(),r()},n=Q(()=>{let i=[];return te.value.forEach(l=>{i.push({name:l.name,path:l.key,size:0,time:"-",type:"ROOT"})}),i}),r=()=>{te.value.some(i=>{i.key===me.value&&Ft.updateCurrentStorageSource(i)})};$t||(Ee(()=>me.value,(i,l)=>{(i&&!Sn.value||l!==void 0)&&(nt.value.push("/"+i),r())}),Ee(()=>Oe.value,i=>{a(!0)}),$t=!0);const s=()=>{if(te.value.length>0){let i=te.value[0].key;me.value=i,nt.value.push("/"+i)}},o=i=>te.value.find(l=>{if(l.key==i)return l});return{loadStorageSourceList:e,storageList:te,findStorageByKey:o,currentStorageKey:me,storageListAsFileList:n}}var jt;const At=typeof window!="undefined",rt=()=>{};function Cn(t,e=200,a={}){return function(n,r){return function(...s){n(()=>r.apply(this,s),{fn:r,thisArg:this,args:s})}}(function(n,r={}){let s,o;return i=>{const l=ae(n),u=ae(r.maxWait);if(s&&clearTimeout(s),l<=0||u!==void 0&&u<=0)return o&&(clearTimeout(o),o=null),i();u&&!o&&(o=setTimeout(()=>{s&&clearTimeout(s),o=null,i()},u)),s=setTimeout(()=>{o&&clearTimeout(o),o=null,i()},l)}}(e,a),t)}At&&((jt=window==null?void 0:window.navigator)==null?void 0:jt.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);var kn=Object.defineProperty,Tn=Object.defineProperties,Pn=Object.getOwnPropertyDescriptors,Ut=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,En=Object.prototype.propertyIsEnumerable,Vt=(t,e,a)=>e in t?kn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,Ln=(t,e)=>{for(var a in e||(e={}))An.call(e,a)&&Vt(t,a,e[a]);if(Ut)for(var a of Ut(e))En.call(e,a)&&Vt(t,a,e[a]);return t};const Et=At?window:void 0;function Ae(...t){let e,a,n,r;if(typeof t[0]=="string"?([a,n,r]=t,e=Et):[e,a,n,r]=t,!e)return rt;let s=rt;const o=Ee(()=>function(u){var f;const p=ae(u);return(f=p==null?void 0:p.$el)!=null?f:p}(e),u=>{s(),u&&(u.addEventListener(a,n,r),s=()=>{u.removeEventListener(a,n,r),s=rt})},{immediate:!0,flush:"post"}),i=()=>{o(),s()};var l;return l=i,$a()&&ja(l),i}function zn(t,e,a={}){const{target:n=Et,eventName:r="keydown",passive:s=!1}=a,o=typeof(i=t)=="function"?i:typeof i=="string"?l=>l.key===i:Array.isArray(i)?l=>i.includes(l.key):i?()=>!0:()=>!1;var i;return Ae(n,r,l=>{o(l)&&e(l)},s)}const ot=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},it="__vueuse_ssr_handlers__";ot[it]=ot[it]||{},ot[it];var Kt,ye,Mn=Object.defineProperty,Dn=Object.defineProperties,_n=Object.getOwnPropertyDescriptors,Nt=Object.getOwnPropertySymbols,Rn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable,Wt=(t,e,a)=>e in t?Mn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;function On(t,e={}){var a,n;const r=(a=e.draggingElement)!=null?a:Et,s=M((n=e.initialValue)!=null?n:{x:0,y:0}),o=M(),i=d=>!e.pointerTypes||e.pointerTypes.includes(d.pointerType),l=d=>{ae(e.preventDefault)&&d.preventDefault(),ae(e.stopPropagation)&&d.stopPropagation()},u=d=>{var h;i(d)&&o.value&&(s.value={x:d.pageX-o.value.x,y:d.pageY-o.value.y},(h=e.onMove)==null||h.call(e,s.value,d),l(d))},f=d=>{var h;i(d)&&o.value&&(o.value=void 0,(h=e.onEnd)==null||h.call(e,s.value,d),l(d))};return At&&(Ae(t,"pointerdown",d=>{var h;if(!i(d)||ae(e.exact)&&d.target!==ae(t))return;const C=ae(t).getBoundingClientRect(),_={x:d.pageX-C.left,y:d.pageY-C.top};((h=e.onStart)==null?void 0:h.call(e,_,d))!==!1&&(o.value=_,l(d))},!0),Ae(r,"pointermove",u,!0),Ae(r,"pointerup",f,!0)),p=((d,h)=>{for(var C in h||(h={}))Rn.call(h,C)&&Wt(d,C,h[C]);if(Nt)for(var C of Nt(h))Bn.call(h,C)&&Wt(d,C,h[C]);return d})({},function(d){if(!Ba(d))return pt(d);const h=Array.isArray(d.value)?new Array(d.value.length):{};for(const C in d.value)h[C]=Oa(()=>({get:()=>d.value[C],set(_){if(Array.isArray(d.value)){const D=[...d.value];D[C]=_,d.value=D}else{const D=(E=Ln({},d.value),Tn(E,Pn({[C]:_})));Object.setPrototypeOf(D,d.value),d.value=D}var E}}));return h}(s)),m={position:s,isDragging:Q(()=>!!o.value),style:Q(()=>`left:${s.value.x}px;top:${s.value.y}px;`)},Dn(p,_n(m));var p,m}(ye=Kt||(Kt={})).UP="UP",ye.RIGHT="RIGHT",ye.DOWN="DOWN",ye.LEFT="LEFT",ye.NONE="NONE";const Fn=["a","s","d","w","q","e","A","S","D","W","Q","E","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Escape"," "];var He=La({name:"V3ImgPreview",props:{showToolbar:{type:Boolean,default:!0},showArrowBtn:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},url:{type:String,default:void 0},escClose:{type:Boolean,default:!0},images:{type:Array,default:()=>[]},showCloseBtn:{type:Boolean,default:!0},index:{type:Number,default:0},on_unmount_v3_ima_preview_app:{type:Function}},setup(t,e){let{emit:a}=e;const n=M(null),r=M(null),{style:s}=On(r),o=pe({visible:!0,imgState:"loading",src:"",imgIndex:t.index}),i=Q(()=>{var S;return((S=t.images)===null||S===void 0?void 0:S.length)>1&&t.showArrowBtn}),l=pe({imgScale:1,imgRotate:0}),u=Q(()=>{var S;return((S=t.images)===null||S===void 0?void 0:S.length)>1}),f=Cn(S=>{if(!t.keyboard)return!1;S.preventDefault();const{key:w}=S;return["s","S","ArrowDown"].includes(w)?d(-.1,!1):["w","W","ArrowUp"].includes(w)?d(.1,!1):w===" "?p():w==="Escape"&&t.escClose?E():["E","e"].includes(w)?m(!0):["Q","q"].includes(w)?m(!1):["a","A","ArrowLeft"].includes(w)?D(!1):["d","D","ArrowRight"].includes(w)?D(!0):void 0},200);zn(Fn,f);const p=()=>{l.imgScale=1,l.imgRotate=0,r.value.style.top="0",r.value.style.left="0"};function m(S){l.imgRotate+=90*(S?1:-1)}function d(S){let w=arguments.length>1&&arguments[1]!==void 0&&arguments[1];l.imgScale<=.2&&S<0||(w?l.imgScale=S:l.imgScale+=S)}function h(S){S.preventDefault(),d(S.deltaY<0?.05:-.05)}function C(S){o.imgState="loading",(w=>{const c=new Image;return c.src=w,new Promise((v,g)=>{c.onload=()=>{v(w)},c.onerror=()=>{g(w)}})})(S).then(()=>{o.imgState="success",o.src=S,p()}).catch(()=>{o.imgState="error"})}function _(){Ke(()=>{Ae(n.value,"mousewheel",h,!1),p(),Ke(()=>t.url!==void 0?C(t.url):Array.isArray(t.images)&&t.images.length>0?C(t.images[o.imgIndex]):console.error("images is not Array or Array length is 0"))})}function E(){var S;o.visible=!1,a("close"),(S=t.on_unmount_v3_ima_preview_app)===null||S===void 0||S.call(t)}function D(S){u.value&&(S?(o.imgIndex++,o.imgIndex>t.images.length-1&&(o.imgIndex=0)):(o.imgIndex--,o.imgIndex<0&&(o.imgIndex=t.images.length-1)),C(t.images[o.imgIndex]))}return za(()=>{window.__V3__IMG__PREVIEW__LOAD__ICON__SVG__||function(S){S.__V3__IMG__PREVIEW__LOAD__ICON__SVG__=!0;var w,c,v,g,y,x='<svg><symbol id="v3-img-close" viewBox="0 0 1045 1024"><path d="M282.517333 213.376l-45.354666 45.162667L489.472 512 237.162667 765.461333l45.354666 45.162667L534.613333 557.354667l252.096 253.269333 45.354667-45.162667-252.288-253.44 252.288-253.482666-45.354667-45.162667L534.613333 466.624l-252.096-253.226667z"  ></path></symbol><symbol id="v3-img-img-error" viewBox="0 0 1024 1024"><path d="M704 328a72 72 0 1 0 144 0 72 72 0 1 0-144 0z"  ></path><path d="M999.904 116.608a32 32 0 0 0-21.952-10.912L521.76 73.792a31.552 31.552 0 0 0-27.2 11.904l-92.192 114.848a32 32 0 0 0 0.672 40.896l146.144 169.952-147.456 194.656 36.48-173.376a32 32 0 0 0-11.136-31.424L235.616 245.504l79.616-125.696a32 32 0 0 0-29.28-49.024L45.76 87.552a32 32 0 0 0-29.696 34.176l55.808 798.016a32.064 32.064 0 0 0 34.304 29.696l176.512-13.184c17.632-1.312 30.848-16.672 29.504-34.272s-16.576-31.04-34.304-29.536L133.44 883.232l-6.432-92.512 125.312-12.576a32 32 0 0 0 28.672-35.04 32.16 32.16 0 0 0-35.04-28.672L122.56 726.848 82.144 149.184l145.152-10.144-60.96 96.224a32 32 0 0 0 6.848 41.952l198.4 161.344-58.752 279.296a30.912 30.912 0 0 0 0.736 14.752 31.68 31.68 0 0 0 1.408 11.04l51.52 154.56a31.968 31.968 0 0 0 27.456 21.76l523.104 47.552a32.064 32.064 0 0 0 34.848-29.632l55.776-798.048a32.064 32.064 0 0 0-7.776-23.232z m-98.912 630.848l-412.576-39.648a31.52 31.52 0 0 0-34.912 28.768 32 32 0 0 0 28.8 34.912l414.24 39.808-6.272 89.536-469.728-42.72-39.584-118.72 234.816-310.016a31.936 31.936 0 0 0-1.248-40.192L468.896 219.84l65.088-81.056 407.584 28.48-40.576 580.192z"  ></path></symbol><symbol id="v3-img-loading" viewBox="0 0 1024 1024"><path d="M834.7648 736.3584a5.632 5.632 0 1 0 11.264 0 5.632 5.632 0 0 0-11.264 0z m-124.16 128.1024a11.1616 11.1616 0 1 0 22.3744 0 11.1616 11.1616 0 0 0-22.3744 0z m-167.3216 65.8944a16.7936 16.7936 0 1 0 33.6384 0 16.7936 16.7936 0 0 0-33.6384 0zM363.1616 921.6a22.3744 22.3744 0 1 0 44.7488 0 22.3744 22.3744 0 0 0-44.7488 0z m-159.744-82.0224a28.0064 28.0064 0 1 0 55.9616 0 28.0064 28.0064 0 0 0-56.0128 0zM92.672 700.16a33.6384 33.6384 0 1 0 67.2256 0 33.6384 33.6384 0 0 0-67.2256 0zM51.2 528.9984a39.168 39.168 0 1 0 78.336 0 39.168 39.168 0 0 0-78.336 0z m34.1504-170.0864a44.8 44.8 0 1 0 89.6 0 44.8 44.8 0 0 0-89.6 0zM187.904 221.7984a50.432 50.432 0 1 0 100.864 0 50.432 50.432 0 0 0-100.864 0zM338.432 143.36a55.9616 55.9616 0 1 0 111.9232 0 55.9616 55.9616 0 0 0-111.9744 0z m169.0112-4.9152a61.5936 61.5936 0 1 0 123.2384 0 61.5936 61.5936 0 0 0-123.2384 0z m154.7776 69.632a67.1744 67.1744 0 1 0 134.3488 0 67.1744 67.1744 0 0 0-134.3488 0z m110.0288 130.816a72.8064 72.8064 0 1 0 145.5616 0 72.8064 72.8064 0 0 0-145.5616 0z m43.7248 169.472a78.3872 78.3872 0 1 0 156.8256 0 78.3872 78.3872 0 0 0-156.8256 0z" fill="" ></path></symbol><symbol id="v3-img-right" viewBox="0 0 1024 1024"><path d="M884.808356 96.170317c0-17.780969-16.723893-32.209586-37.309744-32.209586-20.586874 0-37.310767 14.428617-37.310767 32.209586V927.20035c0 17.780969 16.723893 32.209586 37.310767 32.209586 20.585851 0 37.309744-14.428617 37.309744-32.209586V96.170317zM263.249101 159.859871c-27.619034-21.278629-50.027393-11.659551-50.027393 22.116717v659.490146c0 33.44881 22.481014 43.322691 50.027393 22.116716l407.352615-313.385476c27.65485-21.242813 27.618011-55.784514 0-76.989465L263.249101 159.859871z m449.327612 260.298398c60.265572 48.751331 60.301388 134.302799 0 183.090968L297.061185 939.297876c-70.976518 57.422827-158.459988-25.322735-158.459989-116.158556V200.267163c0-91.12644 87.445608-173.6172 158.459989-116.158557l415.515528 336.049663zM297.061185 84.10963"  ></path></symbol><symbol id="v3-img-left" viewBox="0 0 1024 1024"><path d="M138.60222 96.170317V927.20035c0 17.780969 16.723893 32.209586 37.309744 32.209586 20.586874 0 37.310767-14.428617 37.310767-32.209586V96.170317c0-17.780969-16.723893-32.209586-37.310767-32.209586-20.585851 0-37.309744 14.428617-37.309744 32.209586z m621.560278 63.689554L352.80886 473.208509c-27.618011 21.205974-27.65485 55.747675 0 76.989465l407.353638 313.385476c27.54638 21.205974 50.027393 11.33107 50.027393-22.116716v-659.490146c-0.001023-33.776268-22.408359-43.395346-50.027393-22.116717z m-33.812084-75.750241c71.013357-57.459666 158.458965 25.032116 158.458965 116.157533v622.872157c0 90.835821-87.482447 173.581384-158.459988 116.158556L310.834886 603.249237c-60.301388-48.78817-60.265572-134.339638 0-183.090968L726.350414 84.10963z m0 0"  ></path></symbol><symbol id="v3-img-zoom-out" viewBox="0 0 1024 1024"><path d="M919.264 905.984l-138.912-138.912C851.808 692.32 896 591.328 896 480c0-229.376-186.624-416-416-416S64 250.624 64 480s186.624 416 416 416c95.008 0 182.432-32.384 252.544-86.208l141.44 141.44a31.904 31.904 0 0 0 45.248 0 32 32 0 0 0 0.032-45.248zM128 480C128 285.92 285.92 128 480 128s352 157.92 352 352-157.92 352-352 352S128 674.08 128 480z"  ></path><path d="M625.792 448H336a32 32 0 0 0 0 64h289.792a32 32 0 1 0 0-64z"  ></path></symbol><symbol id="v3-img-zoom-big" viewBox="0 0 1024 1024"><path d="M919.264 905.984l-138.912-138.912C851.808 692.32 896 591.328 896 480c0-229.376-186.624-416-416-416S64 250.624 64 480s186.624 416 416 416c95.008 0 182.432-32.384 252.544-86.208l141.44 141.44a31.904 31.904 0 0 0 45.248 0 32 32 0 0 0 0.032-45.248zM128 480C128 285.92 285.92 128 480 128s352 157.92 352 352-157.92 352-352 352S128 674.08 128 480z"  ></path><path d="M625.792 448H512v-112a32 32 0 0 0-64 0V448h-112a32 32 0 0 0 0 64H448v112a32 32 0 1 0 64 0V512h113.792a32 32 0 1 0 0-64z"  ></path></symbol><symbol id="v3-img-rotate-left" viewBox="0 0 1024 1024"><path d="M884.565333 431.914667c-3.114667 36.266667-22.784 55.893333-59.008 59.008-35.2-3.114667-54.357333-22.741333-57.472-59.008 3.114667-35.157333 22.272-54.314667 57.472-57.429334 36.224 3.114667 55.893333 22.272 59.008 57.429334z m-97.834666 0c3.114667 24.874667 16.042667 38.826667 38.826666 41.941333 22.741333-2.048 35.712-16.042667 38.826667-41.941333-3.114667-24.832-16.085333-38.272-38.826667-40.362667-22.784 3.114667-35.712 16.597333-38.826666 40.362667z m-59.008 82.346666c-1.024 103.466667-34.688 156.245333-100.906667 158.293334-69.376-1.024-104.021333-53.76-104.021333-158.293334 0.981333-104.576 35.157333-158.421333 102.442666-161.536 67.285333 2.133333 101.461333 55.893333 102.485334 161.493334z m-169.216 0c0 89.002667 22.229333 132.992 66.730666 131.925334 44.501333 1.066667 66.773333-42.922667 66.773334-131.968 0-90.026667-22.784-134.528-68.309334-133.546667-42.453333 3.114667-64.213333 47.658667-65.194666 133.546667z m-184.746667 49.664c-58.026667-5.205333-89.6-39.338667-94.72-102.485333 4.096-67.285333 37.76-103.509333 100.906667-108.714667 72.448-0.981333 108.16 50.218667 107.093333 153.728 0 109.738667-37.76 165.12-113.322667 166.144-45.568-2.090667-74.538667-24.32-86.954666-66.773333l32.597333-10.88c7.253333 36.266667 26.453333 53.845333 57.472 52.821333 48.64-2.090667 73.472-45.056 74.538667-128.853333-15.530667 29.994667-41.429333 45.013333-77.653334 45.013333z m3.072-181.674666c-39.338667 3.114667-60.586667 28.458667-63.658667 76.074666 2.048 47.616 23.296 72.96 63.658667 76.074667 40.362667 0 65.194667-18.645333 74.538667-55.893333 0-65.194667-24.874667-97.28-74.538667-96.256z m135.594667 641.578666C230.186667 1023.829333 0.597333 794.24 0.597333 512v-0.981333h53.973334v0.981333c0 252.501333 205.354667 457.898667 457.813333 457.898667 252.501333 0 457.898667-205.397333 457.898667-457.898667 0-252.458667-205.397333-457.813333-457.856-457.813333A457.088 457.088 0 0 0 159.530667 220.586667l120.533333-0.938667h8.106667l-47.061334 47.786667-167.936 1.365333-1.109333-167.936 47.189333-47.872v131.626667A510.933333 510.933333 0 0 1 512.426667 0.128C794.624 0.128 1024.256 229.76 1024.256 512c0 282.282667-229.632 511.872-511.829333 511.872z"  ></path></symbol><symbol id="v3-img-antetype" viewBox="0 0 1024 1024"><path d="M316 672h60c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8zM512 622c22.1 0 40-17.9 40-39 0-23.1-17.9-41-40-41s-40 17.9-40 41c0 21.1 17.9 39 40 39zM512 482c22.1 0 40-17.9 40-39 0-23.1-17.9-41-40-41s-40 17.9-40 41c0 21.1 17.9 39 40 39z"  ></path><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"  ></path><path d="M648 672h60c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8z"  ></path></symbol><symbol id="v3-img-rotate-right" viewBox="0 0 1024 1024"><path d="M375.381 562.517c-57.898-5.162-89.472-39.296-94.634-102.4 4.138-67.2 37.76-103.381 100.864-108.586 72.362-1.024 108.032 50.176 107.008 153.6 0 109.61-37.76 164.906-113.238 165.973-45.525-2.133-74.453-24.32-86.869-66.73l32.597-10.838c7.211 36.181 26.368 53.76 57.387 52.736 48.597-2.048 73.387-44.97 74.453-128.768-15.488 29.995-41.386 45.013-77.568 45.013z m3.115-181.504c-39.296 3.072-60.501 28.459-63.573 75.99 2.048 47.573 23.253 72.96 63.573 76.032 40.32 0 65.152-18.603 74.453-55.851 0-65.152-24.832-97.195-74.453-96.17z m145.835 131.84c0.981-104.448 35.114-158.208 102.4-161.322 67.157 2.09 101.29 55.85 102.357 161.322-1.067 103.424-34.688 156.16-100.821 158.251-69.334-1.067-103.936-53.76-103.936-158.25z m169.088 0c0-89.984-22.784-134.4-68.267-133.418-42.41 3.114-64.128 47.616-65.152 133.418 0 88.96 22.187 132.907 66.688 131.84 44.459 1.067 66.73-42.88 66.73-131.84z m75.989-82.218c3.115-35.158 22.23-54.272 57.387-57.387 36.181 3.115 55.893 22.23 58.965 57.387-3.115 36.224-22.784 55.893-58.965 58.965-35.158-3.115-54.272-22.741-57.387-58.965z m96.17 0c-3.071-24.832-16.042-38.23-38.783-40.32-22.742 3.114-35.67 16.554-38.784 40.32 3.114 24.832 16.042 38.826 38.826 41.898 22.699-2.048 35.67-16.042 38.742-41.898z m-354.175 592.64c-281.984 0-511.36-229.376-511.36-511.403C0 229.973 229.419 0.512 511.403 0.512c157.696 0 298.922 71.765 392.789 184.32V54.613l47.147 47.872-1.11 167.766-167.765-1.366-47.061-47.744h8.106l121.558 0.982a456.704 456.704 0 0 0-353.664-167.68c-252.246 0-457.43 205.226-457.43 457.429 0 252.288 205.184 457.515 457.43 457.515S968.875 764.16 968.875 511.872v-0.981h53.888v0.981c0 282.027-229.376 511.403-511.36 511.403z"  ></path></symbol></svg>',k=(k=document.getElementsByTagName("script"))[k.length-1].getAttribute("data-injectcss");if(k&&!S.__iconfont__svg__cssinject__){S.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(L){console&&console.log(L)}}function z(){y||(y=!0,v())}w=function(){var L,T=document.createElement("div");T.innerHTML=x,x=null,(T=T.getElementsByTagName("svg")[0])&&(T.setAttribute("aria-hidden","true"),T.style.position="absolute",T.style.width=0,T.style.height=0,T.style.overflow="hidden",(L=document.body).firstChild?function(q,b){b.parentNode.insertBefore(q,b)}(T,L.firstChild):L.appendChild(T))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(w,0):(c=function(){document.removeEventListener("DOMContentLoaded",c,!1),w()},document.addEventListener("DOMContentLoaded",c,!1)):document.attachEvent&&(v=w,g=S.document,y=!1,function L(){try{g.documentElement.doScroll("left")}catch(T){return void setTimeout(L,50)}z()}(),g.onreadystatechange=function(){g.readyState=="complete"&&(g.onreadystatechange=null,z())})}(typeof window!="undefined"?window:global),_()}),Object.assign(Object.assign(Object.assign({vImagesWrap:n,imgContainer:r},pt(o)),pt(l)),{handleClose:E,toggleImg:D,initImgSize:p,dragStyle:s,handleScale:d,handleRotate:m,visibleArrowBtn:i,isMultiple:u,handleClickMaskClose:function(S){S.target.classList.contains("img-container")&&E()}})}});const Z=t=>(Fa("data-v-50804152"),t=t(),Ia(),t),In={class:"icon img-loading rotate-animation","aria-hidden":"true"},$n=[Z(()=>F("use",{"xlink:href":"#v3-img-loading"},null,-1))],jn=["src"],Un=[Z(()=>F("use",{"xlink:href":"#v3-img-img-error"},null,-1))],Vn=[Z(()=>F("use",{"xlink:href":"#v3-img-close"},null,-1))],Kn=[Z(()=>F("svg",{class:"icon","aria-hidden":"true"},[F("use",{"xlink:href":"#v3-img-left"})],-1))],Nn=[Z(()=>F("svg",{class:"icon","aria-hidden":"true"},[F("use",{"xlink:href":"#v3-img-right"})],-1))],Wn={key:3,class:"v3-img-preview-toolbar"},Hn=[Z(()=>F("use",{"xlink:href":"#v3-img-zoom-out"},null,-1))],qn=[Z(()=>F("use",{"xlink:href":"#v3-img-zoom-big"},null,-1))],Gn=[Z(()=>F("use",{"xlink:href":"#v3-img-antetype"},null,-1))],Yn=[Z(()=>F("use",{"xlink:href":"#v3-img-rotate-left"},null,-1))],Xn=[Z(()=>F("use",{"xlink:href":"#v3-img-rotate-right"},null,-1))];(function(t,e){e===void 0&&(e={});var a=e.insertAt;if(t&&typeof document!="undefined"){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",a==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}})(`.icon[data-v-50804152] {
  width: 1em;
  height: 1em;
  vertical-align: -0.15em;
  fill: currentColor;
  overflow: hidden;
}
.v-images-wrap[data-v-50804152] {
  z-index: 200;
  user-select: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(3px);
  color: #fff;
}
.v-images-wrap[data-v-50804152] .img-loading[data-v-50804152],
.v-images-wrap[data-v-50804152] .img-content[data-v-50804152] {
  font-size: 50px;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  margin: auto;
  transition: all 0.2s;
  cursor: move;
}
.v-images-wrap[data-v-50804152] .img-container[data-v-50804152] {
  z-index: 201;
  position: absolute;
  height: 100vh;
  width: 100vw;
  top: 0;
  left: 0;
  text-align: center;
}
.v-images-wrap[data-v-50804152] .img-container[data-v-50804152] .img-content[data-v-50804152] {
  max-width: 100%;
  max-height: 100%;
}
.v-images-wrap[data-v-50804152] .img-container[data-v-50804152] .img-error[data-v-50804152] {
  font-size: 300px;
  color: #d8d8d8;
}
.v-images-wrap[data-v-50804152] .rotate-animation[data-v-50804152] {
  animation: rotate-50804152 1.5s linear infinite;
}
.v-images-wrap[data-v-50804152] .arrow[data-v-50804152] {
  width: 42px;
  height: 42px;
  text-align: center;
  line-height: 42px;
  position: absolute;
  top: 50%;
  border-radius: 50%;
  transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  font-size: 24px;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 280;
  background: rgba(0, 0, 0, 0.3);
}
.v-images-wrap[data-v-50804152] .arrow[data-v-50804152][data-v-50804152]:hover {
  opacity: 0.8;
  transform: translateY(-50%) scale(1.2);
}
.v-images-wrap[data-v-50804152] .arrow-left[data-v-50804152] {
  left: 50px;
}
.v-images-wrap[data-v-50804152] .arrow-right[data-v-50804152] {
  right: 50px;
}
.v-images-wrap[data-v-50804152] .close-btn[data-v-50804152] {
  z-index: 205;
  position: absolute;
  right: 50px;
  top: 50px;
  width: 36px;
  height: 36px;
  font-size: 22px;
  line-height: 36px;
  text-align: center;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.2s;
  color: #e7e5e5;
  background: rgba(0, 0, 0, 0.3);
}
.v-images-wrap[data-v-50804152] .close-btn[data-v-50804152][data-v-50804152]:hover {
  opacity: 0.8;
  transform: scale(1.2);
}
.v-images-wrap[data-v-50804152] .v3-img-preview-toolbar[data-v-50804152] {
  z-index: 205;
  position: absolute;
  bottom: 10%;
  font-size: 26px;
  width: 100%;
  display: flex;
  justify-content: center;
  cursor: pointer;
}
.v-images-wrap[data-v-50804152] .v3-img-preview-toolbar[data-v-50804152] section[data-v-50804152] {
  height: 44px;
  bottom: 10%;
  padding: 0 22px;
  display: flex;
  align-items: center;
  border-radius: 22px;
  background: rgba(0, 0, 0, 0.3);
  color: #c3c3c3;
}
.v-images-wrap[data-v-50804152] .v3-img-preview-toolbar[data-v-50804152] section[data-v-50804152] svg[data-v-50804152] {
  box-sizing: content-box;
  padding: 0 10px;
  transition: all 0.2s;
}
.v-images-wrap[data-v-50804152] .v3-img-preview-toolbar[data-v-50804152] section[data-v-50804152] svg[data-v-50804152][data-v-50804152]:hover {
  transform: scale(1.2);
}
@keyframes rotate-50804152 {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
`),He.render=function(t,e,a,n,r,s){return $(),Ma(_a,{name:"fade"},{default:Da(()=>[t.visible?($(),K("div",{key:0,class:"v-images-wrap",onClick:e[10]||(e[10]=function(){return t.handleClickMaskClose&&t.handleClickMaskClose(...arguments)}),ref:"vImagesWrap"},[Qe(($(),K("svg",In,$n,512)),[[Ze,t.imgState==="loading"]]),F("div",{ref:"imgContainer",style:et(t.dragStyle),class:"img-container"},[Qe(F("img",{class:"img-content",onDragstart:e[0]||(e[0]=Je(()=>{},["prevent"])),src:t.src,style:et(`transform: scale(${t.imgScale}) rotate(${t.imgRotate}deg);`),alt:""},null,44,jn),[[Ze,t.imgState==="success"]]),Qe(($(),K("svg",{class:"icon img-content img-error",onDragstart:e[1]||(e[1]=Je(()=>{},["prevent"])),"aria-hidden":"true",style:et(`transform: scale(${t.imgScale}) rotate(${t.imgRotate}deg);`)},Un,36)),[[Ze,t.imgState==="error"]])],4),t.showCloseBtn?($(),K("svg",{key:0,class:"icon close-btn","aria-hidden":"true",onClick:e[2]||(e[2]=Je(function(){return t.handleClose&&t.handleClose(...arguments)},["stop"]))},Vn)):ve("",!0),t.visibleArrowBtn?($(),K("div",{key:1,class:"arrow arrow-left",onClick:e[3]||(e[3]=o=>t.toggleImg(!1))},Kn)):ve("",!0),t.visibleArrowBtn?($(),K("div",{key:2,class:"arrow arrow-right",onClick:e[4]||(e[4]=o=>t.toggleImg(!0))},Nn)):ve("",!0),t.showToolbar?($(),K("div",Wn,[F("section",null,[($(),K("svg",{class:"icon","aria-hidden":"true",onClick:e[5]||(e[5]=o=>t.handleScale(-.1,!1))},Hn)),($(),K("svg",{class:"icon","aria-hidden":"true",onClick:e[6]||(e[6]=o=>t.handleScale(.1,!1))},qn)),($(),K("svg",{class:"icon","aria-hidden":"true",onClick:e[7]||(e[7]=function(){return t.initImgSize&&t.initImgSize(...arguments)})},Gn)),($(),K("svg",{class:"icon","aria-hidden":"true",onClick:e[8]||(e[8]=o=>t.handleRotate(!1))},Yn)),($(),K("svg",{class:"icon","aria-hidden":"true",onClick:e[9]||(e[9]=o=>t.handleRotate(!0))},Xn))])])):ve("",!0)],512)):ve("",!0)]),_:1})},He.__scopeId="data-v-50804152";let wa={};const Ht="v3-img-preview-container-id";let be={};function Sa(t){if(be._instance)return!1;Array.isArray(t)&&(t={images:t}),typeof t=="string"&&(t={url:t}),t=Object.assign(Object.assign({},wa),t);let e=document.getElementById(Ht);return e||(e=document.createElement("div"),e.id=Ht,document.body.appendChild(e)),be=Ra(He,Object.assign(Object.assign({},t),{on_unmount_v3_ima_preview_app:()=>be.unmount()})),be.mount(e),be}(()=>{const t=He;return t.install=(e,a)=>{wa=a,e.config.globalProperties.$v3ImgPreviewFn=Sa},t})();let Qn=Ct(),lt=he(),qt=M(!1),Gt=M(!1),Yt=M(!1),Xt=M(!1),Qt=M(!1);function Zn(){return{openVideo:()=>{qt.value=!0},dialogVideoVisible:qt,openText:()=>{Gt.value=!0},dialogTextVisible:Gt,openOffice:()=>{Yt.value=!0},dialogOfficeVisible:Yt,openImage:i=>{let l=[],u=0;Qn.zfileConfig.imagePreview.mode==="only"?l.push(i.url):lt.filterFileByType("image").forEach((p,m)=>{i.name===p.name&&(u=m),l.push(p.url)}),Sa({images:l,index:u})},openAudio:()=>{lt.updateAudioList(lt.filterFileByType("audio"))},openPdf:()=>{Xt.value=!0},dialogPdfVisible:Xt,open3d:()=>{Qt.value=!0},dialog3dVisible:Qt}}const{encodeAllIgnoreSlashes:Zt}=Na();let{routerRef:we,fullpath:st,storageKey:Y,currentPath:Fe}=ze(),{getPathPwd:Jn,putPathPwd:er}=Pt();const{storageListAsFileList:tr}=xn();let Se=he(),fe=Me();const ut=Pa(fe.globalConfig.siteName);let yt=Ct();const{openAudio:ar,openImage:nr,openOffice:rr,openPdf:or,openText:ir,openVideo:lr,open3d:sr}=Zn(),de=M(!1),Jt=M(!1);let bt=pe([]);if(bt.length===0)for(let t=0;t<yt.zfileConfig.skeleton.size;t++)bt.push({});let X=pe({path:"",password:"",orderBy:"",orderDirection:""});const ea=M(!1);let{selectRows:ur,clearSelection:cr}=kt();function xa(){const t=({prop:i,order:l})=>{X.orderBy=i,X.orderDirection=l==="descending"?"desc":"asc",e()},e=i=>{if(!Y.value)return;de.value=!0,X.path=Fe.value;let l=i||{};l.storageKey=Y.value,l.path=Fe.value,l.password=l.password||Jn(),l.orderBy=X.orderBy,l.orderDirection=X.orderDirection;let u=Y.value;Va(l).then(f=>{let p=f.data.passwordPattern;if(er(p,l.password),u!==Y.value)return;let m=f.data.files,d=X.path;if(d!==""&&d!=="/"){let h=Be.basename(Be.resolve(Fe.value,"../"));m.unshift({name:h||"/",path:Be.resolve(d,"../"),type:"BACK"})}Se.updateFileList(m),de.value=!1,Jt.value=!0,ur.value=[],st.value?ut.value=fe.globalConfig.siteName+" | "+st.value[st.value.length-1]:ut.value=fe.globalConfig.siteName+" | \u9996\u9875",a(l)}).catch(f=>{let p=f.response.data;p.code===U.responseCode.INVALID_PASSWORD?(N.warning("\u5BC6\u7801\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01"),o()):p.code===U.responseCode.REQUIRED_PASSWORD?(N.warning("\u6B64\u6587\u4EF6\u5939\u9700\u8981\u5BC6\u7801\uFF0C\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"),o()):N.error(p.msg)})},a=i=>{let l={storageKey:Y.value,path:Fe.value,password:i.password};Ka(l).then(u=>{fe.updateFolderConfig(u.data),Y.value!==Se.oldStorageKey&&Se.updateOldStorageKey(Y.value)}).finally(()=>{ea.value=!0})},n=i=>{if(!!i.name)if(Se.updateCurrentClickRow(i),i.type==="FILE"){const{batchDownloadFile:l}=Ca();switch(i.fileType){case"video":lr();break;case"image":nr(i);break;case"text":ir();break;case"audio":ar(i);break;case"office":rr(i);break;case"pdf":or(i);break;case"three3d":sr(i);break;default:l(i)}cr()}else if(i.type==="ROOT")we.value.push(i.path);else if(i.type==="BACK"){let l=We("/"+Y.value+"/"+i.path);l=Zt(l),we.value.push(l)}else{let l=We("/"+Y.value+"/"+i.path+"/"+i.name);l=Zt(l),we.value.push(l)}};let r=Q(()=>{let i=yt.zfileConfig.skeleton.enable,l=yt.zfileConfig.skeleton.show;return i?l==="always"?de.value:Jt.value?!1:de.value:!1}),s=Q(()=>r.value?!1:de.value),o=()=>{re.prompt("\u6B64\u6587\u4EF6\u5939\u5DF2\u52A0\u5BC6\uFF0C\u8BF7\u8F93\u5165\u5BC6\u7801","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputType:"password",inputValidator(i){return!!i},inputErrorMessage:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A."}).then(({value:i})=>{e({password:i})}).catch(()=>{if((X.path==="/"||X.path==="")&&fe.globalConfig.rootShowStorage===!0)Se.updateFileList(tr.value),we.value.push("/"),ut.value=fe.globalConfig.siteName+" | \u9996\u9875",de.value=!1;else{let i=Be.resolve(X.path,"../");we.value.push("/"+Y.value+i)}})};return{loadFile:e,openRow:n,searchParam:X,sortChangeMethod:t,skeletonLoading:r,skeletonData:bt,basicLoading:s,initStorageConfig:ea,loadFileConfig:a}}let dr=he(),fr=Me(),{storageKey:ct,currentPath:ta}=ze(),{selectRows:W,selectRow:gr,selectFolders:Ie,selectFiles:dt}=kt(),{getPathPwd:pr}=Pt();const aa=Ua();function Ca(){const{loadFile:t}=xa(),e=u=>{if(!W.value&&W.value.length===0){N.warning("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u6587\u4EF6");return}let f;const m=(()=>{let d={isChrome:!1,tips:""},h=aa.browser,C=aa.version;return h==="Chrome"?d.isChrome=!0:d.tips=`<br><span class="text-gray-500 text-xs">\u68C0\u6D4B\u5230\u5F53\u524D\u6D4F\u89C8\u5668\u4E3A <b>${h}-${C}</b>, \u53EF\u80FD\u4E0D\u652F\u6301\u6B64\u529F\u80FD\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u8C37\u6B4C\u6D4F\u89C8\u5668!</span>`,d})();u!=null&&u.name?f=`\u662F\u5426\u786E\u8BA4\u4E0B\u8F7D\u6587\u4EF6 <span class="text-blue-500">${u.name}</span> \uFF1F`:W.value.length===1?(f=`\u662F\u5426\u786E\u8BA4\u4E0B\u8F7D\u6587\u4EF6 <span class="text-blue-500">${W.value[0].name}</span> \uFF1F`,u=W.value[0]):W.value.length>1&&(f=`\u662F\u5426\u786E\u8BA4\u6279\u91CF\u4E0B\u8F7D ${W.value.length} \u4E2A\u6587\u4EF6\uFF1F`,m.isChrome||(f+=m.tips)),re.confirm(f,"\u63D0\u793A",{dangerouslyUseHTMLString:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"info",callback:d=>{d==="confirm"&&(u!=null&&u.name?(console.log("\u8FDB\u884C\u6307\u5B9A\u6587\u4EF6\u4E0B\u8F7D, \u6587\u4EF6:",u),a(u.url)):W.value.forEach(h=>{h.type==="FILE"&&(console.log("\u6279\u91CF\u9009\u4E2D\u6587\u4EF6\u4E0B\u8F7D, \u6587\u4EF6:",h),n(h.url))}))}})},a=u=>{window.open(u)},n=u=>{const f=document.createElement("iframe");f.style.display="none",f.style.height=0,f.src=u,document.body.appendChild(f),setTimeout(()=>{f.remove()},5*60*1e3)};return{batchDownloadFile:e,rename:()=>{let u=gr.value;if(u===null){N.warning("\u8BF7\u5148\u9009\u4E2D\u4E00\u4E2A\u6587\u4EF6\u6216\u6587\u4EF6\u5939\uFF01");return}re.prompt(`\u5C06 <b>${u.name}</b> \u4FEE\u6539\u4E3A\uFF1A`,"\u63D0\u793A",{dangerouslyUseHTMLString:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputValue:u.name,inputValidator(f){return!!f},inputErrorMessage:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A."}).then(({value:f})=>{let p={storageKey:ct.value,path:u.path,name:u.name,newName:f},m;u.type==="FILE"?m=vn:u.type==="FOLDER"&&(m=mn);const d=ht.service({fullscreen:!0,text:"\u91CD\u547D\u540D\u4E2D...",background:"rgba(255, 255, 255, 0.6)"});m(p).then(()=>{N.success("\u91CD\u547D\u540D\u6210\u529F")}).finally(()=>{d.close(),t()})})},newFolder:()=>{re.prompt(`\u5728 <b>${ta.value}</b> \u4E0B\u521B\u5EFA\u6587\u4EF6\u5939\uFF0C\u8BF7\u8F93\u5165\u8981\u521B\u5EFA\u7684\u6587\u4EF6\u5939\u540D\u79F0`,"\u63D0\u793A",{dangerouslyUseHTMLString:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",draggable:!0,inputValidator(u){return u?u.includes("/")?"\u6587\u4EF6\u5939\u540D\u79F0\u4E0D\u80FD\u5305\u542B /":!0:"\u6587\u4EF6\u5939\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}}).then(({value:u})=>{let f={storageKey:ct.value,path:ta.value,name:u};pn(f).then(()=>{N.success("\u521B\u5EFA\u6210\u529F")}).finally(()=>{t()})})},moveTo:()=>{N.warning("\u6682\u672A\u5B9E\u73B0")},copyTo:()=>{N.warning("\u6682\u672A\u5B9E\u73B0")},batchDelete:()=>{if(!fr.permission.delete)return;if(W.value.length===0){N.warning("\u8BF7\u5148\u81F3\u5C11\u9009\u4E2D\u4E00\u4E2A\u6587\u4EF6\u6216\u6587\u4EF6\u5939\uFF01");return}let u=W.value.length===1?"\u662F\u5426\u786E\u8BA4\u5220\u9664 ":"\u662F\u5426\u786E\u8BA4\u6279\u91CF\u5220\u9664 ",f=["s3","tencent","aliyun","qiniu","minio","huawei","upyun"];Ie.value.length>0&&(u+=" "+Ie.value.length+" \u4E2A\u6587\u4EF6\u5939"),Ie.value.length>0&&dt.value.length>0&&(u+="\uFF0C"),dt.value.length>0&&(u+=dt.value.length+" \u4E2A\u6587\u4EF6"),Ie.value.length>0&&f.includes(dr.currentStorageSource.type.key)&&(u+=" (\u4E0D\u652F\u6301\u5220\u9664\u975E\u7A7A\u6587\u4EF6\u5939)"),u+="?",re.confirm(u,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",draggable:!0,callback:p=>{if(p==="confirm"){let m={storageKey:ct.value,deleteItems:[]};W.value.forEach(h=>{m.deleteItems.push({path:h.path,name:h.name,type:h.type,password:pr(h.path)})});const d=ht.service({text:"\u5220\u9664\u4E2D...",background:"rgba(0, 0, 0, .3)"});hn(m).then(h=>{N.success(h.msg),t()}).finally(()=>{d.close()})}}})}}}Ct();let hr=Me(),ne=he();const vr=xt("Meta"),mr=xt("Control"),yr=xt("Shift");let br=Q(()=>vr.value||mr.value),{batchDelete:na}=Ca();const{skeletonLoading:ra,openRow:ft}=xa(),{selectRows:Ve,selectRow:oa,clearSelection:wt,toggleRowSelection:$e,toggleAllSelection:wr}=kt();window.addEventListener("keydown",function(t){var e;t.key==="Escape"&&je()?wt():t.key==="a"&&(t.metaKey||t.ctrlKey)&&je()?(t.preventDefault(),wr()):t.key==="Delete"&&je()?na&&((e=Ve==null?void 0:Ve.value)==null?void 0:e.length)>0&&(t.preventDefault(),na()):t.key==="Backspace"&&je()&&ne.fileList.length>0&&ne.fileList[0].type==="BACK"&&St(ne.fileList[0])},!1);const je=()=>Sr()&&ka()===!1,Sr=()=>document.querySelector(".zfile-index-body:hover"),ka=()=>!!document.querySelector(".el-popup-parent--hidden"),xr=()=>document.querySelector(".is-message-box .el-input__inner")===document.activeElement,Te=M(-1),Pe=M(-1),{pressed:Cr}=Aa();Ee(()=>Cr.value,(t,e)=>{t===!1&&e===!0&&(Te.value=-1,Pe.value=-1)});let St;function Br(){return St=(n,r)=>{var i;if(r===void 0){ft(n);return}let s=r.type==="selection";if(!s&&hr.globalConfig.fileClickMode==="click"){ft(n);return}if(ra.value)return;let o=Ve.value.length===1&&((i=oa.value)==null?void 0:i.name)===n.name;if(yr.value){let l=ne.fileList.findIndex(u=>u.name===oa.value.name);if(l!==null){let u=ne.fileList.findIndex(m=>m.name===n.name),f=Math.min(u,l),p=Math.max(u,l);for(let m=f+1;m<p;m++){let d=ne.fileList[m];$e(d,!0)}}}else!br.value&&!o&&!s&&wt();$e(n)},{tableClickRow:St,tableDbClickRow:n=>{ra.value||ft(n)},tableHoverRow:(n,r,s,o)=>{if(o.buttons===1&&Te.value!==-1){if(Pe.value===-1){wt();let p=ne.fileList[Te.value];$e(p,!0)}let i=n.index,l=Pe.value>=0?Pe.value:i-1,u=Math.min(l,i),f=Math.max(l,i);for(let p=u;p<=f;p++){let m=ne.fileList[p];$e(m,!0)}Pe.value=i}},tableLeaveRow:(n,r,s,o)=>{o.buttons===1&&Te.value===-1&&(Te.value=n.index)}}}let Ue=he(),xe=Me(),Ce=M(!1),ia=!1;const oe=M(!1),gt=M(""),j=pe([]),ie=pe([]),J=new Map,le=new Map;let kr=0;const la={error:1,uploading:2,waiting:3,finished:4};function Or(){let{storageKey:t,currentPath:e}=ze();const a=xe.globalConfig.maxFileUploads,n=c=>{c=document.querySelector("body");const v=b=>{var I,O,B,Lt;let P=((O=(I=b.dataTransfer)==null?void 0:I.files)==null?void 0:O.length)>0;if(k(),Ce.value=!1,ka()&&P||xr()||!t.value||!xe.permission.upload)return;b.stopPropagation(),b.preventDefault();const A=ht.service({text:"\u6587\u4EF6\u8BFB\u53D6\u4E2D...",background:"rgba(0, 0, 0, .3)"}),R=((B=b.clipboardData)==null?void 0:B.items)||((Lt=b.dataTransfer)==null?void 0:Lt.items);y(R).then(De=>{if(Ke(()=>{A.close()}),De.length===0)return;const zt=()=>{oe.value=!0,De.forEach(Ye=>{o({file:Ye,uploadToPath:e.value})})};De.length>100?re.confirm(`\u6587\u4EF6\u6570\u91CF\u4E3A ${De.length} \u4E2A\uFF0C\u662F\u5426\u786E\u8BA4\u4E0A\u4F20\uFF1F`,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"success",callback:Ye=>{Ye==="confirm"&&zt()}}):zt()})};let g=null;c.addEventListener("dragenter",b=>{!t.value||oe.value||!xe.permission.upload||(g=b.target,x(),b.stopPropagation(),b.preventDefault(),Ce.value=!0)},!1),c.addEventListener("dragover",function(b){!t.value||oe.value||!xe.permission.upload||(b.stopPropagation(),b.preventDefault(),Ce.value=!0)},!1),c.addEventListener("dragleave",function(b){!t.value||oe.value||!xe.permission.upload||(g===b.target&&(k(),Ce.value=!1),b.stopPropagation(),b.preventDefault())},!1),c.addEventListener("drop",v,!1),c.addEventListener("paste",v,!1);const y=b=>Xe(this,null,function*(){let P=[],A=[];if(b){let R=new Array(...b);for(let I=0;I<R.length;I++){let O=R[I],B=null;if(O.webkitGetAsEntry){if(B=O.webkitGetAsEntry(),!B&&(B=O.getAsFile(),B)){P.push(B);continue}}else if(O.getAsEntry)B=O.getAsEntry();else{N.warning("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u62D6\u62FD\u4E0A\u4F20");return}A.push(B)}if(A.length>0)for(let I=0;I<A.length;I++){let O=A[I];if(O){let B=yield q(O);Array.isArray(B)?T(B,P):P.push(B)}}}return P}),x=()=>{c.classList.add("dragging-over")},k=()=>{c.classList.remove("dragging-over")};function z(b){return new Promise((P,A)=>{b.file(R=>{P(R)})})}function L(b){return new Promise((P,A)=>{b.readEntries(R=>{P(R)})})}function T(b,P){for(let A=0;A<b.length;A++)Array.isArray(b[A])?T(b[A],P):P.push(b[A])}function q(b){return Xe(this,null,function*(){let P=b.fullPath||"",A=[];if(b.isFile){let R=yield z(b);return R.dropUploadPath=P,R}else if(b.isDirectory){let R=b.createReader(),I=yield L(R);for(let O=0;O<I.length;O++){let B=yield q(I[O]);A.push(B)}return A}})}},r=()=>{oe.value=!0,gt.value="file"},s=()=>{oe.value=!0,gt.value="folder",Ke(()=>{document.getElementsByClassName("el-upload__input")[0].webkitdirectory=!0})},o=c=>{i(c.file,c.uploadToPath)},i=(c,v)=>{const g=kr++;if(v=v||e.value,c.webkitRelativePath||c.dropUploadPath){let k=c.webkitRelativePath||c.dropUploadPath;k.startsWith("/")||(k="/"+k);let z=k.split("/");z.forEach((L,T)=>{let q=T===0,b=z.length-1===T;q||b||L&&(v+="/"+L)})}let y={storageKey:t.value,path:U.removeDuplicateSeparator(v),name:c.name,size:c.size};if(console.log("\u5F53\u524D\u4E0A\u4F20\u4FE1\u606F:",y,", \u5F53\u524D\u540C\u65F6\u4E0A\u4F20\u6587\u4EF6\u6570:",_.value.totalUploading,"\u9650\u5236\u540C\u65F6\u4E0A\u4F20\u6587\u4EF6\u6570:",a),_.value.totalUploading>=a){console.log(`\u4E0A\u4F20\u6587\u4EF6\u6570\u8D85\u51FA ${a}, \u7B49\u5F85\u4E0A\u4F20`),ie.push({index:g,file:c,uploadToPath:v});return}let x={name:c.name,size:c.size,speed:"-",progress:0,loaded:0,status:"uploading",startTime:Date.now(),file:c,index:g};j.push(x),J.set(g,ue.CancelToken.source()),le.set(g,j[j.length-1]),yn(y).then(k=>{const{on:z}=Mt(`cancel-upload-${g}`);z(()=>{let b=J.get(g);b&&(b.cancel(),j.find((P,A)=>{let R=P.name===c.name;return R&&j.splice(A,1),R}))});let L=U.storageType.proxyType,T=U.storageType.s3Type,q=U.storageType.micrsoftType;L.includes(Ue.currentStorageSource.type.key)?l(c,k.data,g):T.includes(Ue.currentStorageSource.type.key)?u(c,k.data,g):q.includes(Ue.currentStorageSource.type.key)?f(c,k.data,g):Ue.currentStorageSource.type.key==="upyun"&&p(c,k.data,g)}).catch(k=>{m(g,k)})},l=(c,v,g)=>{let y=new FormData;y.append("file",c),ue.post(v,y,{cancelToken:J.get(g).token,onUploadProgress:x=>{h(x,g,!0)}}).then(()=>{d(g)}).catch(x=>{m(g,x)})},u=(c,v,g)=>{ue.put(v,c,{withCredentials:!1,cancelToken:J.get(g).token,onUploadProgress:y=>{h(y,g)}}).then(()=>{d(g)}).catch(y=>{m(g,y)})},f=(c,v,g)=>{let y=1,x=0,k=0,z=c.size;const L=104857599;if(z===0){m(g,"\u5F53\u524D\u5B58\u50A8\u7C7B\u578B\u4E0D\u652F\u6301\u4E0A\u4F20\u7A7A\u6587\u4EF6");return}const T=()=>{x+L>=z?k=z:k=x+L,y>1&&J.set(g,ue.CancelToken.source());let q=c.slice(x,k);ue.put(`${v}`,q,{cancelToken:J.get(g).token,timeout:1e7,headers:{"Content-Type":"application/octet-stream","Content-Range":`bytes ${x}-${k-1}/${c.size}`},type:"sync",withCredentials:!1,onUploadProgress:b=>{if(b.lengthComputable){let P=le.get(g);const A=b.loaded+x;P.size=z,P.loaded=A,P.progress=Math.round(A/z*100),P.speed=U.fileSizeFormat(Math.round(A/(Date.now()-P.startTime)*1e3))}}}).then(b=>{b.status===202?(x+=L,y+=1,T()):(b.status===201||b.status===200)&&d(g)}).catch(b=>{m(g,b)})};T()},p=(c,v,g)=>{let y=JSON.parse(v),x=new FormData;x.append("name",c.name),x.append("authorization",y.signature),x.append("policy",y.policy),x.append("file",c),ue.post(y.url,x,{withCredentials:!1,cancelToken:J.get(g).token,onUploadProgress:k=>{h(k,g)}}).then(()=>{d(g)}).catch(k=>{m(g,k)})},m=(c,v)=>{var y;let g=le.get(c);g.status="error",g.endTime=Date.now(),g.msg=((y=v==null?void 0:v.response)==null?void 0:y.data)||v},d=c=>{let v=le.get(c);v.progress=100,v.status="finished",v.endTime=Date.now(),v.msg="\u4E0A\u4F20\u6210\u529F"},h=(c,v,g)=>{let y=le.get(v);y.size=c.total,y.loaded=c.loaded,y.progress=Math.round(c.loaded/c.total*100),y.speed=U.fileSizeFormat(Math.round(c.loaded/(Date.now()-y.startTime)*1e3)),console.log("uploadFileInfo",y,g),g&&y.progress===100&&(y.msg="\u4E0A\u4F20\u5B8C\u6210, \u670D\u52A1\u5668\u4E2D\u8F6C\u4E2D...")},C=c=>{re.confirm(`\u662F\u5426\u786E\u5B9A\u53D6\u6D88\u6587\u4EF6 ${c.name} \u4E0A\u4F20\uFF1F`,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u8FD4\u56DE",type:"warning",callback:v=>{v==="confirm"&&Mt(`cancel-upload-${c.index}`).emit()}})},_=Q(()=>{let c=j.length,v=0,g=0;j.forEach(x=>{x.status==="uploading"?v++:x.status==="finished"&&g++});let y=v+ie.length;return{totalSize:c,totalUploading:v,totalFinish:g,totalUploadingAndWaiting:y}}),E=Q(()=>{let c=[];return c.push(...j),ie.forEach(v=>{c.push({name:v.file.name,size:v.file.size,status:"waiting",msg:"\u6392\u961F\u4E2D...",index:v.index})}),c.sort((v,g)=>{let y=v.status,x=g.status;return y!==x?la[y]-la[x]:v.startTime!==g.startTime?v.startTime-g.startTime:v.endTime-g.endTime}),console.log("uploadProgressInfoSorted",c),c});ia||(Ee(()=>_.value.totalUploading,c=>{if(c<a)if(console.log("\u68C0\u6D4B\u5230\u4E0A\u4F20\u4E2D\u7684\u6587\u4EF6\u4E2A\u6570\u5C0F\u4E8E\u6700\u5927\u4E0A\u4F20\u9650\u5236."),ie.length===0)console.log("\u7B49\u5F85\u4E0A\u4F20\u7684\u6587\u4EF6\u6570\u4E3A 0, \u65E0\u9700\u7EE7\u7EED\u4E0A\u4F20.");else{let g=ie.splice(0,1)[0];o({file:g.file,uploadToPath:g.uploadToPath}),console.log("\u5F00\u59CB\u4ECE\u7B49\u5F85\u961F\u5217\u4E2D\u83B7\u53D6\u4E0A\u4F20\u6587\u4EF6: ",g.file.name)}}),ia=!0);const D=c=>{if(c==null)return;let v=j.findIndex((g,y)=>{if(g.index===c)return j.splice(y,1),!0});v===-1&&(v=ie.findIndex((g,y)=>{if(g.index===c)return ie.splice(y,1),!0})),v!==-1&&(le.delete(c),J.delete(c))};return{visible:oe,uploadMode:gt,openUploadDialog:r,openUploadFolderDialog:s,cancelUpload:C,dropState:Ce,listenDropFile:n,beforeUpload:o,uploadFile:i,uploadProgressInfoSorted:E,uploadProgressInfoStatistics:_,clearALlFinishedUploadFile:()=>{let c=0;for(let v=j.length-1;v>=0;v--){let g=j[v];g.status==="finished"&&(c++,j.splice(v,1),le.delete(g.index),J.delete(g.index))}return c},removeUploadFileByIndex:D,retryUpload:c=>{console.log("\u91CD\u65B0\u4E0A\u4F20\u6587\u4EF6",c),D(c.index),i(c.file)}}}export{xa as a,Br as b,Ca as c,Or as d,Zn as e,xn as f,Pt as g,Rr as h,Be as p,We as r,he as u};
